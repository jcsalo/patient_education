<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Locally-Advanced Adenocarcinoma – Patient Education</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea385d0e468b0dd5ea5bf0780b1290d9.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-2603e723dd3c74fbcc2f741deb348a59.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Patient Education</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./scripts.html"> 
<span class="menu-text">Scripts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./patient_education_plan.html"> 
<span class="menu-text">Plan</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.youtube.com/channel/UC5Deez8jUMnLhcf72-cHA7Q"> 
<span class="menu-text">YouTube</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    <div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="eso_advanced.htm"><i class="bi bi-file-slides"></i>RevealJS</a></li><li><a href="eso_advanced.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Locally-Advanced Adenocarcinoma</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">1 Intro</h2>
<p>I’m Dr Jonathan Salo, a GI Cancer Surgeon at the in Charlotte, North Carolina If you’re seeing this video, changes are you or someone close to you has had an encounter with esophageal cancer. These videos are designed to educate you about cancer and its treatment and help you and you cancer care team make the right decisions for you.</p>
<p>Of course, there is no substitute for the expert opinions of your cancer care team.</p>
</section>
<section id="esophageal-cancer-2" class="level2">
<h2 class="anchored" data-anchor-id="esophageal-cancer-2">4 Esophageal Cancer (2)</h2>
<p>For a refresher, esophageal cancer, as it grows, can tends to make it difficult for patients to swallow.</p>
<p>So patients with esophageal cancer fit into two main groups:</p>
<ul>
<li>A small group who don’t have any difficulty eating that have <em>early</em> stage disease</li>
<li>Majority of patients who have some difficulty eating or may have weight loss who have <em>advanced</em> disease.</li>
</ul>
</section>
<section id="esophageal-cancer-3" class="level2">
<h2 class="anchored" data-anchor-id="esophageal-cancer-3">Esophageal Cancer (3)</h2>
<p>This video will focus on Advanced Stage Disease</p>
<p>We will post videos about early stage disease, so take a look in the description.</p>
</section>
<section id="advanced-stage-cancer-4" class="level2">
<h2 class="anchored" data-anchor-id="advanced-stage-cancer-4">Advanced Stage Cancer (4)</h2>
<p><em>Advanced</em> esophageal cancer consists of two categories: Locally Advanced and Metastatic.</p>
<ul>
<li>Locally Advanced -&gt; T3M0</li>
<li>Metastatic -&gt; M1</li>
</ul>
</section>
<section id="metastatic-cancerm1-5" class="level2">
<h2 class="anchored" data-anchor-id="metastatic-cancerm1-5">2 Metastatic Cancer:M1 (5)</h2>
<p>Metastatic cancers are those that have signs of spread to other organs such as the lungs, liver, or bones.</p>
<p>These cancers are treated primarily with chemotherapy.</p>
<p>We have other videos that focus on metastatic cancers.</p>
</section>
<section id="locally-advanced-m0-6" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-m0-6">Locally-advanced: M0 (6)</h2>
<p>Locally-advanced cancers are M0, which means there is no evidence of metastasis, or spread to other parts of the body. In addition, they are T3 or node-positive</p>
</section>
<section id="locally-advanced-t3-or-n-7" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-t3-or-n-7">Locally-advanced: T3 or N+ (7)</h2>
<p>Locally-advanced cancers are not only M0, but they are T3 or node-positive.</p>
<p>If this terminology is not familiar to you, please refer to our video on Diagnosis and Staging. There is a link above and in the description below.</p>
</section>
<section id="types-of-esophageal-cancer-8" class="level2">
<h2 class="anchored" data-anchor-id="types-of-esophageal-cancer-8">4 Types of Esophageal Cancer (8)</h2>
<p>To make things a bit more complicated, there are two types of esophageal cancer: Adenocarcinoma and Squamous Cell Carcinoma.</p>
<p>The treatment is in many ways similar, but there are enough differences that we will have a separate video that focuses on squamous cell carcinoma.</p>
</section>
<section id="types-of-esophageal-cancer-9" class="level2">
<h2 class="anchored" data-anchor-id="types-of-esophageal-cancer-9">Types of Esophageal Cancer (9)</h2>
<p>This video will focus on locally-advanced <em>adenocarcinoma</em></p>
</section>
<section id="locally-advanced-10" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-10">(6) Locally Advanced (10)</h2>
<p>Locally-advanced cancers frequently have localized spread of cancer cells outside of the visible tumor.</p>
</section>
<section id="locally-advanced-11" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-11">Locally Advanced (11)</h2>
<p>Surgery removed the visible tumor and the surrounding tissue, but does not always remove microscopic spread of cancer which can’t be seen with the naked eye.</p>
</section>
<section id="locally-advanced-12" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-12">Locally Advanced (12)</h2>
<p>If surgery is performed as the only therapy for locally-advanced cancer, there is a risk that cancer cells can be left behind</p>
</section>
<section id="locally-advanced-13" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-13">Locally Advanced (13)</h2>
<p>Preoperative therapy is administered before surgery</p>
</section>
<section id="locally-advanced-14" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-14">Locally Advanced (14)</h2>
<p>And is designed to kill cancer cells in the tumor, nodes, and any cancer cells in the surrounding area</p>
</section>
<section id="locally-advanced-15" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-15">Locally Advanced (15)</h2>
<p>This therapy typically involves chemotherapy</p>
</section>
<section id="locally-advanced-16" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-16">Locally Advanced (16)</h2>
<p>Which can circulate all throughout the body</p>
</section>
<section id="locally-advanced-17" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-17">Locally Advanced (17)</h2>
<p>Chemotherapy can be combined with radiation in some cases</p>
</section>
<section id="locally-advanced-18" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-18">Locally Advanced (18)</h2>
<p>The overall goal is shrinking the tumor and killing nearby cancer cells</p>
</section>
<section id="locally-advanced-19" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-19">Locally Advanced (19)</h2>
<p>After preoperative therapy has shrunk the tumor and any other cancer cells, surgery can be performed</p>
</section>
<section id="locally-advanced-20" class="level2">
<h2 class="anchored" data-anchor-id="locally-advanced-20">Locally Advanced (20)</h2>
<p>Preoperative therapy combined with surgery offers the best chance to remove all of the cancer, without leaving any behind</p>
</section>
<section id="adenocarcinoma-preoperative-therapy-21" class="level2">
<h2 class="anchored" data-anchor-id="adenocarcinoma-preoperative-therapy-21">(4) Adenocarcinoma Preoperative Therapy (21)</h2>
<p>For adenocarcinoma of the esophagus, there are two different approaches to preoperative therapy.</p>
<p>One uses chemotherapy and radiation together, followed by surgery</p>
<p>The other uses chemotherapy before and after surgery, without radiation therapy</p>
</section>
<section id="chemotherapy-radiation---surgery-22" class="level2">
<h2 class="anchored" data-anchor-id="chemotherapy-radiation---surgery-22">Chemotherapy + Radiation -&gt; Surgery (22)</h2>
<p>The chemotherapy and radiation strategy uses chemotherapy and radiation together</p>
<p>Chemotherapy is given intraveneously once per week for 6 weeks</p>
<p>Radiation is given five days per week for 6 weeks</p>
</section>
<section id="chemotherapy-radiation---surgery-23" class="level2">
<h2 class="anchored" data-anchor-id="chemotherapy-radiation---surgery-23">Chemotherapy + Radiation -&gt; Surgery (23)</h2>
<p>The chemotherapy is a low dose, designed to make the radiation more effective</p>
<p>The therapy is generally well tolerated</p>
</section>
<section id="cross-clinical-trial-24" class="level2">
<h2 class="anchored" data-anchor-id="cross-clinical-trial-24">(2) CROSS Clinical Trial (24)</h2>
<p>The effectiveness of this approach was proven scientifically in the CROSS clinical trial</p>
<p>This was a scientific study published in 2010</p>
<p>363 patients with locally-advanced esophageal cancer were divided into two treatment groups:</p>
<p>One group was treated with surgery alone</p>
<p>The other group was treated with chemotherapy and radiation first, followed by surgery</p>
</section>
<section id="cross-clinical-trial-25" class="level2">
<h2 class="anchored" data-anchor-id="cross-clinical-trial-25">CROSS Clinical Trial (25)</h2>
<p>The results of the trial were quite dramatic: There was better control of the cancer in the group that received chemotherapy and radiation prior to surgery. This group had longer survival than the group treated with surgery alone.</p>
</section>
<section id="cross-clinical-trial-26" class="level2">
<h2 class="anchored" data-anchor-id="cross-clinical-trial-26">CROSS Clinical Trial (26)</h2>
<p>For the past 15 years, chemotherapy and radiation, followed by surgery, was established as the most effective therapy. This is known as trimodality therapy, beause it uses a combination of three different therapies.</p>
</section>
<section id="adenocarcinoma-preoperative-therapy-27" class="level2">
<h2 class="anchored" data-anchor-id="adenocarcinoma-preoperative-therapy-27">(4) Adenocarcinoma Preoperative Therapy (27)</h2>
<p>The second and somewhat newer approach to preoperative therapy for esophgeal adenocarcinoma is treatment with chemotherapy, followed by surgery, followed by additional chemotherapy</p>
</section>
<section id="chemo---surgery---chemo-28" class="level2">
<h2 class="anchored" data-anchor-id="chemo---surgery---chemo-28">Chemo -&gt; Surgery -&gt; Chemo (28)</h2>
<p>Chemotherapy is administered intravenously every other week for 4 doses over 8 weeks</p>
<p>Surgery is then performed 4-6 weeks later</p>
<p>Chemotherapy is again administered intravenously every other week for 4 more doses over 8 weeks</p>
</section>
<section id="chemotherapy-options-29" class="level2">
<h2 class="anchored" data-anchor-id="chemotherapy-options-29">Chemotherapy Options (29)</h2>
<p>There are two commonly used “recipies” for chemotherapy:</p>
<p>FLOT consists of four drugs</p>
<p>FOLFOX consists of three drugs</p>
<p>As you might expect, FLOT is more powerful against cancer, while FOLFOX is easier to tolerate</p>
</section>
<section id="preoperative-therapy-30" class="level2">
<h2 class="anchored" data-anchor-id="preoperative-therapy-30">(2) Preoperative Therapy (30)</h2>
<p>If we compare Chemotherapy + Radiation (or CROSS) with chemotherapy (FLOT)..</p>
<p>We see that Chemotherapy + Radiation has a longer track record and is better tolerated</p>
<p>A central venous port is usually placed to assist with chemotherapy</p>
<p>The radiation can lead to irritation of the lining of the esophagus called radiation esophagitis. One can think of this as a sunburn on the inside of the esophagus. The result is that the therapy can make eating temporarily worse before it gets better. Usually the last two weeks of radiation therapy are the worst. By two weeks after radiation is completed, the tumor has shrunk enough that eating is usually better than before therapy.</p>
<p>For this reason, a temporary feeding tube is frequently necessary for patients getting chemotherapy and radiation</p>
</section>
<section id="preoperative-therapy-31" class="level2">
<h2 class="anchored" data-anchor-id="preoperative-therapy-31">Preoperative Therapy (31)</h2>
<p>On the other hand, FLOT chemotherapy, administered both before and after surgery, has been shown to be more effective than chemotherapy and radiation.</p>
<p>FLOT chemotherapy, however, has more side effects than chemotherapy and radiation.</p>
<p>As the chemotherapy begins to work, patients who have trouble eating before therapy find gradual improvement in their eating. As a result, a feeding tube might be less likely used with FLOT chemotherapy.</p>
</section>
<section id="preoperative-therapy-32" class="level2">
<h2 class="anchored" data-anchor-id="preoperative-therapy-32">Preoperative Therapy (32)</h2>
<p>So we have two different approaches for therapy prior to surgery, and each has favorable and unfavorable features</p>
</section>
<section id="preoperative-therapy-33" class="level2">
<h2 class="anchored" data-anchor-id="preoperative-therapy-33">Preoperative Therapy (33)</h2>
<p>In general, we think that FLOT may be more effective, but CROSS is better tolerated</p>
</section>
<section id="preoperative-therapy-34" class="level2">
<h2 class="anchored" data-anchor-id="preoperative-therapy-34">Preoperative Therapy (34)</h2>
<p>A medical oncologist, who specializes in chemotherapy treatment, will make a recommnendation for preoperative therapy based upon a patient’s age, overall health, and any medical problems such as heart disease or kidney disease.</p>
</section>
<section id="additional-topics-35" class="level2">
<h2 class="anchored" data-anchor-id="additional-topics-35">Additional Topics (35)</h2>
<p>We hope you have found this video helpful. Here are some other topics for which videos have been posted or are planned.</p>
<p>Feel free to leave a comment or a question, or if you have suggestions for future videos.</p>
<p>If you or a family member have had an encounter with esophageal cancer, I would love to hear about your experience, so please take a minute to leave a comment below.</p>
<p>We’re constantly creating new videos, so please subscribe to be notified of new videos when we post them.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/jcsalo\.github\.io\/patient_education\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>